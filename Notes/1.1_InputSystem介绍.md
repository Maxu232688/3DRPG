# InputSystem

课程中并没有讲InputSystem相关的知识，仅做了展示随后便开始使用了。

你要是对这玩意完全不懂，可以看一下这东西咋用，到后面写PlayerInputManager的时候就很轻松了。

---

## 创建InputAction

由于我们之前安装过InputSystem插件了，现在在Assets下新建文件夹InputActions，在其下创建 Input Actions 文件（一般在Create菜单的最下方）。改名为PlayerInputActions。

随后我们来介绍InputSystem。

---

## 什么是InputSystem

InputSystem是Unity提供的一种新的输入系统，相对于老的输入系统更具拓展性和可自定义的替代方案。\
说人话就是一套更好用更方便的用于检测键盘、鼠标、手柄、摇杆等设备输入的系统。

### 与InputManager的区别

InputManager是Unity中老的输入系统，就是我们常用的 Input 类，比如其中的 `GetMouseButtonDown()`，`GetKeyDown()`方法。\
在使用老输入系统时，我们往往要在 Update() 函数里面写判断逻辑。\
但使用了新的输入系统后，不仅可以像老输入系统一样使用，还增加了输入配置的概念，新输入系统讲输入操作进行了封装，可以在Unity内进行输入配置文件编辑，不需要再写代码判断设备输入了，只需要把重心放在输入对应键后处理什么逻辑上就行了。

比如老输入系统我们经常这样做：

```csharp
void Update()
{
    if (Input.GetMouseButtonDown(0))
    {
        //......
        print("Left Button Down. ");
    }
}
```

此时把脚本挂载在场景物体中就能检测鼠标输入了。

但是在新输入系统中，我们只需要这样做：

首先在Project中要有InputActions配置文件。即上文**创建InputAction**中所作的工作。

双击打开这个文件，可以看到分成了三栏。

点击最左边栏中的➕号，添加一套输入，命名为Player。\
中间栏就生成了一个输入动作，将其命名为LeftButtonTest。\
此时看右侧栏，Action Type 是 Button，意思是按钮类型。\
将中间栏中的输入动作展开，在子对象上进行编辑。选择右侧栏中的Binding -> Mouse -> Left Button\
此时该操作就自动关联左键了，点击上方的Save Asset保存。

在场景中要操作的对象上挂载 Player Input组件，将我们创建的配置文件关联上去（拖到Actions栏）\
在Behavior选项中选择Invoke Unity Events，使用Unity事件。\
展开下方的Events\
展开发现有个Player，其下有个方法LeftButtonTest，点击其右下角的➕号，将挂载了有如下代码的对象拖进去。关联上后点击右边的菜单，选择 脚本名 -> LeftButtonTest。

```csharp
public void LeftButtonTest(InputAction.CallbackContext context)
{
    print("New Input System Left Button Down.");
}
```

此时运行，按下左键，你会发现控制台打印了上述内容。

## 老输入系统的重新开启

新输入系统导入后会禁用老输入系统，如果我还想用该咋整呢？

File -> Build Setting -> Player Settings -> Other Settings -> Configuration -> Active Input Handling

可以同时启用，也可以只启用其中之一，每次启用过后会重启Unity。\
只启用一种，用另一种的时候会报错。

我这里建议只启用新输入系统。

---

综上所述，新的输入系统不需要写代码来判断设备输入了，代码工作量更少了，更易于管理项目。

值得注意的是Input System是有版本要求的，尽可能选择Unity的新版本去使用它。