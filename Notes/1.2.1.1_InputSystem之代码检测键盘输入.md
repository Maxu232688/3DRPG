# InputSystem之代码检测键盘输入

## 获取当前键盘设备

这里是需要引用命名空间的。\
新输入系统提供了对应的输入设备类，帮助我们对某一种设备输入进行检测。

```csharp
using UnityEngine.InputSystem;

//.....

Keyboard kbd = Keyboard.current; 
// 注意：Keyboard类不能实例化，这个操作就是获取当前连接的键盘

```

## 单个按键——按下抬起长按

如果想和老输入系统一样使用，就是想在Update里面监听按键按下，那么使用方法如下：

```csharp

void Update()
{
    // 空格键当前帧是否按下
    if (Keyboard.current.spaceKey.wasPressedThisFrame)
    {
        print("Space Key Pressed. ");
    }
    // 空格键当前帧是否释放
    if (Keyboard.current.spaceKey.wasReleasedThisFrame)
    {
        print("Space Key Released. ");
    }
    // x键是否长按
    // 要注意IsPressed是方法，isPressed是属性
    if (Keyboard.current.xKey.isPressed) 
    {
        print("X Key OnPressed. ");
    }

}
```

想检测其他的键，可以进入Keyboard类中看看都有什么键。

## 通过事件监听按键按下

通过给Keyboard对象中的文本输入事件，添加委托函数，便可以获得每次输入的内容。

```csharp
void Start()
{
    Keyboard keyboard = Keyboard.current;

    keyboard.onTextInput += (c) =>
    {
        print("lambda Get " + c);
    }
    keyboard.onTextInput += TextInput;
}

private void TextInput(char c)
{
    print("Function Get " + c);
}

// lambda表达式加入的方式没办法取消，因为没办法在委托列表里面减去这个没名字的函数。
```

此时挂载脚本到场景中运行，按下键盘上的键就能在控制台中看到都获取到了什么。

## 任意键按下监听

可以处理任意键按下抬起长按相关的逻辑

```csharp
void Update()
{
    if (Keyboard.current.anyKey.WasPressedThisFrame)
    {
        print("任意键按下");
    }

    //抬起与长按与上文类似
}
```

---

在新输入系统中很少使用这样的方式监听，但是不排除会有这样的需求。