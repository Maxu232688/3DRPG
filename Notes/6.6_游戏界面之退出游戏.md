# 游戏界面之退出游戏

暂停界面上的四个按钮我们一个都没做，显然退出和继续最好做。

先来做退出，打开LevelController

```csharp
// 在Controller里面提供入口，具体的实现单独分开
protected LevelFinisher m_finisher => LevelFinisher.instance;

public virtual void Exit()
{
    m_finisher.Exit();
}
```

在Scripts\Level下新建脚本LevelFinisher

```csharp
public class LevelFinisher : Singleton<LevelFinisher>
{
    public float loadingDelay = 1f;
    // 要退出到哪个场景里面
    public string exitToScene;
    // 退出时发送的事件
    public UnityEvent OnExit;
    protected LevelPauser m_pauser => LevelPauser.instance;
    protected Level m_level => Level.instance;
    protected GameLoader m_loader => GameLoader.instance;

    protected virtual IEnumerator ExitRoutine()
    {
        // 先恢复游戏运行，为啥呢，因为要让这个暂停界面先消失再播放加载界面
        m_pauser.Pause(false);
        // 游戏到此就不能再暂停了
        m_pauser.canPause = false;
        // 停止检测玩家输入
        m_level.player.inputs.enabled = false;
        // 等一会让动画播完
        yield return new WaitForSeconds(loadingDelay);
        // 把鼠标显示出来
        Game.LockCursor(false);
        // 加载要去的场景
        m_loader.Load(exitToScene);
        OnExit?.Invoke();
    }
    public virtual void Exit()
    {
        // 首先退出的话场景里面一切东西都没用了，所以直接把所有的携程停了
        StopAllCoroutines();
        // 启动退出的携程
        StartCoroutine(ExitRoutine());
    }
}
```

回到场景中，打开_LEVEL_预制体，给它挂上LevelFinisher。

打开PauseScreen预制体，给它挂上LevelController。\
再打开退出按钮，添加事件，点击时运行LevelController中的Exit方法。

此时可以运行一下看看，就能退出到关卡选择界面了。

ResumeButton就更简单了。接着打开LevelController

```csharp
protected LevelPauser m_pauser => LevelPauser.instance;

public virtual void Resume()
{
    var value = m_pauser.isPaused;
    m_pauser.Pause(!value);
}
```

然后在预制体里面给这个按钮加上这个函数的事件监听就可以了。

**当然这里课里面还没做，我是凭感觉写的，大差不差吧应该**